<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>üõí KCF MODZ STORE - Gamer Edition </title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg-dark:#141217;
    --accent-red:#ff2e1f;
    --accent-gold:#ffbf3d;
    --gold:#f6d24d;
    --purple:#b76cf6;
    --glass: rgba(255,255,255,0.03);
    --muted: rgba(255,255,255,0.6);
  }
  *{box-sizing:border-box}
  html,body{height:100%; margin:0; font-family:'Montserrat',sans-serif; -webkit-font-smoothing:antialiased}
  body{
    background: linear-gradient(180deg,#21181a 0%, #0f0e0f 60%);
    color:#fff;
    overflow-x:hidden;
  }

  /* moving neon lights */
  .bg-wrap{position:fixed;inset:0;z-index:-2;overflow:hidden}
  .light{position:absolute;border-radius:50%;filter:blur(90px);mix-blend-mode:screen;opacity:.9}
  .light.red{width:900px;height:900px;background:radial-gradient(circle,#ff2a1f,rgba(255,42,31,0) 40%);left:-12%;top:-8%;animation:drift1 22s linear infinite}
  .light.gold{width:650px;height:650px;background:radial-gradient(circle,#ffd24d,rgba(255,210,77,0) 40%);right:-8%;top:6%;animation:drift2 18s linear infinite}
  .light.soft{width:520px;height:520px;background:radial-gradient(circle,#ff7a3a,rgba(255,122,58,0) 40%);left:18%;bottom:-18%;animation:drift3 26s linear infinite;opacity:.6}
  @keyframes drift1{0%{transform:translate(0,0)}50%{transform:translate(18vw,-44vh)}100%{transform:translate(0,0)}}
  @keyframes drift2{0%{transform:translate(0,0)}50%{transform:translate(-10vw,-32vh)}100%{transform:translate(0,0)}}
  @keyframes drift3{0%{transform:translate(0,0)}50%{transform:translate(-12vw,-18vh)}100%{transform:translate(0,0)}}

  /* container */
  .wrap{max-width:1040px;margin:18px auto;padding:28px 24px 120px}
  header{text-align:center;margin-bottom:18px}
  h1{font-size:40px;margin:0;color:var(--gold);text-shadow:0 10px 40px rgba(255,120,40,0.08);letter-spacing:1px}
  .tag{color:var(--muted);margin-top:8px}

  /* big card */
  .card{
    background: linear-gradient(180deg,var(--glass), rgba(0,0,0,0.28));
    border-radius:18px;padding:26px;border:1px solid rgba(255,255,255,0.03);
    box-shadow:0 30px 80px rgba(0,0,0,0.7);
    margin-bottom:18px;
  }

  /* login fields */
  .login-grid{display:flex;gap:22px;align-items:flex-end;flex-wrap:wrap;justify-content:center}
  .field{width:360px;max-width:92%}
  label{display:block;color:var(--gold);font-weight:800;margin-bottom:8px}
  input[type="text"], input[type="password"]{
    width:100%;padding:16px;border-radius:14px;border:1px solid rgba(255,255,255,0.04);
    background:rgba(0,0,0,0.36);color:#fff;font-size:16px;outline:none;transition:transform .12s, box-shadow .14s;
  }
  input:focus{transform:translateY(-3px);box-shadow:0 12px 40px rgba(255,40,40,0.06)}

  /* actions */
  .actions{display:flex;gap:14px;justify-content:center;margin-top:18px;flex-wrap:wrap}
  .btn{
    padding:16px 26px;border-radius:46px;border:none;cursor:pointer;font-weight:900;font-size:18px;color:#111;
    background:linear-gradient(90deg,var(--accent-red),var(--accent-gold));
    box-shadow:0 22px 60px rgba(255,60,60,0.12), 0 0 35px rgba(255,160,20,0.06);
    transform-origin:center;
    transition:transform .12s ease, box-shadow .12s ease, filter .12s;
    animation:buttonPulse 3s infinite;
  }
  .btn.create{background:linear-gradient(90deg,#ff7b3b,#ffd38a)}
  @keyframes buttonPulse{
    0%{filter:brightness(1);transform:scale(1)}
    50%{filter:brightness(1.18);transform:scale(1.02)}
    100%{filter:brightness(1);transform:scale(1)}
  }
  .btn.ghost{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.04);box-shadow:none;animation:none}

  /* pages - each section as its own page (hidden by default) */
  section.page{display:none;padding:10px 0 80px}
  section.page.active{display:block}

  /* sala buttons */
  .sala-grid{display:flex;gap:20px;flex-wrap:wrap;justify-content:center;margin-top:24px}
  .sala-btn{
    width:240px;height:96px;border-radius:18px;display:flex;align-items:center;justify-content:center;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.14));
    border:1px solid rgba(255,255,255,0.03);
    color:var(--gold);font-weight:900;font-size:20px;cursor:pointer;
    box-shadow:0 20px 60px rgba(0,0,0,0.6);
    transition:transform .14s, box-shadow .14s, filter .14s;
  }
  .sala-btn:hover{transform:translateY(-8px);box-shadow:0 34px 90px rgba(0,0,0,0.7);filter:brightness(1.06)}
  .sala-btn .sub{display:block;font-weight:600;font-size:12px;color:var(--muted);margin-top:6px}

  /* products page (large and airy) */
  .products-wrap{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin-top:18px}
  .product-card{
    padding:28px;border-radius:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.2));
    border:1px solid rgba(255,255,255,0.03);box-shadow:0 18px 60px rgba(0,0,0,0.6);
    text-align:center;
  }
  .product-title{font-size:22px;color:var(--gold);font-weight:900;margin-bottom:8px}
  .product-desc{color:var(--muted);margin-bottom:16px}
  .product-cta{
    display:inline-block;padding:14px 22px;border-radius:40px;background:linear-gradient(90deg,var(--accent-red),var(--accent-gold));
    color:#111;font-weight:900;text-decoration:none;box-shadow:0 18px 56px rgba(255,80,80,0.14);transition:transform .14s,filter .14s;
    animation:ctaGlow 3s infinite;
  }
  @keyframes ctaGlow{
    0%{filter:drop-shadow(0 0 0 rgba(255,180,50,0))}
    50%{filter:drop-shadow(0 0 40px rgba(255,140,40,0.55))}
    100%{filter:drop-shadow(0 0 0 rgba(255,180,50,0))}
  }

  /* Productos Gratis: purple titles + larger card */
  .gratis-hero{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.28));
    padding:28px;border-radius:18px;border:1px solid rgba(255,255,255,0.03);
    text-align:center;box-shadow:0 22px 80px rgba(0,0,0,0.7);
  }
  .gratis-title{font-size:34px;color:var(--purple);font-weight:900;text-shadow:0 6px 26px rgba(183,108,246,0.12);margin-bottom:18px}
  .gratis-list{display:grid;grid-template-columns:1fr;gap:18px;max-width:760px;margin:0 auto}
  .gratis-item{padding:22px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.2));border:1px solid rgba(255,255,255,0.02)}
  .gratis-item h3{color:var(--purple);font-size:20px;margin:0 0 8px}
  .gratis-item p{color:var(--muted);margin:0 0 12px}
  .gratis-item .link{
    display:inline-block;padding:14px 22px;border-radius:40px;background:linear-gradient(90deg,#ff6b00,#ffd38a);
    color:#111;font-weight:900;text-decoration:none;box-shadow:0 14px 46px rgba(255,100,40,0.12);transition:transform .12s,filter .12s;animation:btnPulse .9s infinite alternate;
  }
  @keyframes btnPulse{from{transform:translateY(0);filter:brightness(1)}to{transform:translateY(-3px);filter:brightness(1.12)}}

  /* chat/floating */
  #chatToggle{position:fixed;right:20px;bottom:20px;width:72px;height:72px;border-radius:50%;background:linear-gradient(90deg,var(--accent-red),var(--accent-gold));display:flex;align-items:center;justify-content:center;color:#111;font-weight:900;cursor:pointer;box-shadow:0 26px 80px rgba(255,60,60,0.16)}
  #chatWindow{position:fixed;right:20px;bottom:110px;width:420px;max-width:92vw;height:520px;border-radius:12px;background:linear-gradient(180deg,rgba(0,0,0,0.9),rgba(6,6,6,0.96));display:none;border:1px solid rgba(255,210,77,0.06);box-shadow:0 30px 80px rgba(0,0,0,0.6);z-index:9999}
  .chat-head{padding:14px;border-bottom:1px solid rgba(255,255,255,0.03);color:var(--gold);font-weight:900;display:flex;justify-content:space-between;align-items:center}
  .chat-body{padding:12px;height:360px;overflow:auto;display:flex;flex-direction:column;gap:10px}
  .chat-footer{display:flex;gap:8px;padding:12px;border-top:1px solid rgba(255,255,255,0.03)}
  .chat-msg{padding:10px;border-radius:10px;background:rgba(255,255,255,0.03);color:#fff;max-width:86%}
  .user-msg{align-self:flex-end;background:linear-gradient(90deg,rgba(255,42,42,0.95),rgba(255,200,50,0.95));color:#111;font-weight:800}

  /* modal create account */
  .modal-backdrop{
    position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:9998;
  }
  .modal{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.36));
    padding:20px;border-radius:12px;width:360px;max-width:92%;
    border:1px solid rgba(255,255,255,0.04);
    box-shadow:0 30px 80px rgba(0,0,0,0.7);
  }
  .modal h3{margin:0 0 10px;color:var(--gold)}
  .modal .input{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:rgba(0,0,0,0.36);color:#fff;margin-bottom:10px}
  .modal .row{display:flex;gap:8px}
  .modal .btn{flex:1;padding:10px;border-radius:8px;font-size:14px}

  /* loading overlay */
  #loadingOverlay{
    display:none;
    position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:100000;align-items:center;justify-content:center;
    color:#fff;font-size:22px;font-weight:800;flex-direction:column;
  }
  .loader-ring{width:90px;height:90px;border-radius:50%;border:8px solid rgba(255,255,255,0.08);border-top-color:var(--accent-red);animation:spin 1s linear infinite;margin-bottom:14px}
  @keyframes spin{to{transform:rotate(360deg)}}

  /* HIDE floater buttons by default (no !important so JS can change it) */
  #whatsappButton, #chatFab {
    display: none;
  }

  /* whatsapp floating button - styled like a FAB */
  #whatsappButton {
    position: fixed;
    right: 90px; /* left of the chat FAB which is at 20px */
    bottom: 20px;
    z-index: 10001;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: none; /* controlled by JS */
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 10px 40px rgba(0,0,0,0.5);
    background: linear-gradient(180deg, #25D366, #1fae4a);
    border: 4px solid rgba(255,255,255,0.06);
  }
  #whatsappButton img {
    width: 28px;
    height: 28px;
    display: block;
  }
  #whatsappButton:active { transform: scale(0.98); }

  /* responsive adjustments */
  @media(max-width:420px){
    #whatsappButton { right: 84px; width:56px; height:56px; }
    .sala-btn{width:100%}
  }

  /* responsive */
  @media(max-width:860px){
    .login-grid{flex-direction:column;align-items:center}
    .sala-btn{width:46%}
    .product-card{padding:20px}
    .gratis-title{font-size:28px}
  }
  @media(max-width:480px){
    .sala-btn{width:100%}
    .btn{width:100%}
    .actions{flex-direction:column}
  }

  /* chat styles (duplicated below too, but it's okay) */
  .chat-fab{
    position:fixed;
    bottom:20px;
    right:20px;
    width:60px;height:60px;border-radius:50%;
    background:linear-gradient(90deg,#ff416c,#ff4b2b);
    color:#fff;border:none;font-size:26px;cursor:pointer;
    box-shadow:0 0 30px rgba(255,75,43,0.8);z-index:10000;
    display: none; /* controlled by JS */
    align-items:center;justify-content:center;
  }
  .chat-box{
    position:fixed;right:20px;bottom:90px;width:320px;
    background:#111;border-radius:12px;overflow:hidden;z-index:9999;
    color:#fff;display:flex;flex-direction:column;
    box-shadow:0 10px 40px rgba(0,0,0,0.6);
  }
  .chat-header{background:#ff4b2b;padding:10px;text-align:center;font-weight:700;display:flex;align-items:center;justify-content:center;}
  .chat-header button{position:absolute;right:8px;top:6px;background:transparent;border:none;color:white;font-size:16px}
  .chat-messages{height:260px;padding:10px;overflow:auto;font-size:14px;background:linear-gradient(#0f0f0f,#151515);}
  .chat-input{display:flex;border-top:1px solid #222;}
  .chat-input input{flex:1;padding:10px;border:none;background:#1b1b1b;color:#fff;outline:none;}
  .chat-input button{background:#ff4b2b;border:none;color:#fff;padding:10px 14px;cursor:pointer;font-weight:700;}
  .chat-message { margin:6px 0; padding:8px 10px; border-radius:8px; background:rgba(255,255,255,0.03); }
  .chat-message.me { background: linear-gradient(90deg,#ffd38a,#ff7b3b); color:#111; font-weight:700; align-self:flex-end;}
  .chat-message .meta { font-size:12px; color:rgba(255,255,255,0.6); margin-bottom:4px; }

</style>
</head>
<body>
  <div class="bg-wrap" aria-hidden="true">
    <div class="light red"></div>
    <div class="light gold"></div>
    <div class="light soft"></div>
  </div>

  <div class="wrap">
    <header>
      <h1>üõí KCF MDZ </h1>
      <div class="tag"></div>
    </header>

    <!-- LOGIN CARD -->
    <div class="card" id="loginCard">
      <div style="text-align:center;margin-bottom:6px">
        <strong style="color:var(--gold);font-size:18px">Inicia sesi√≥n</strong>
      </div>

      <div class="login-grid">
        <div class="field">
          <label for="username">Usuario</label>
          <input id="username" type="text" placeholder="Tu usuario" autocomplete="username" />
        </div>

        <div class="field">
          <label for="password">Contrase√±a</label>
          <input id="password" type="password" placeholder="Contrase√±a" autocomplete="current-password" />
        </div>
      </div>

     
 <div class="actions">
        <button id="btnLogin" class="btn">Iniciar sesi√≥n</button>
        <button id="btnCreate" class="btn create">Crear cuenta</button>
        <button id="bt" class="btn ghost">Login oficial</button>
      </div>

      <p style="text-align:center;color:var(--muted);margin-top:14px">Disfruta de los productos üõí.</p>
    </div>

    <!-- SALA -->
    <section id="page-sala" class="page">
      <div class="card">
        <h2 style="margin:0;color:var(--gold);font-size:28px">üî• Sala de estar</h2>
        <p id="salaWelcome" style="margin-top:10px;color:var(--muted)"></p>
        <div class="sala-grid" aria-label="Men√∫ principal">
          <div class="sala-btn" onclick="navTo('page-productos')">üõí Productos<span class="sub">Tienda</span></div>
          <div class="sala-btn" onclick="navTo('page-cuenta')">üë§ Mi Cuenta<span class="sub">Perfil</span></div>
          <div class="sala-btn" onclick="navTo('page-pedidos')">üì¶ Pedidos<span class="sub">Tus compras</span></div>
        </div>
      </div>
    </section>

    <!-- PRODUCTOS -->
    <section id="page-productos" class="page">
      <div class="card">
        <h2 style="margin:0;color:var(--gold);font-size:28px">üõç Productos</h2>
        <div class="products-wrap">
          <div class="product-card">
            <div class="product-title">BR MODS</div>
            <div class="product-desc"> PREGUNTA PRECIOS AL PRIVADOüõíüî•</div>
            <a class="product-cta" href="#" onclick="alert('Proceso de compra demo')">Ver / Comprar</a>
          </div>
          <div class="product-card">
            <div class="product-title">Drip Client</div>
            <div class="product-desc">PREGUNTA PEECIOS AL PRIVADOüõíüî•</div>
            <a class="product-cta" href="#" onclick="alert('Proceso de compra demo')">Ver / Comprar</a>
          </div>
        </div>
        <div style="text-align:center;margin-top:18px"><button class="btn ghost" onclick="navTo('page-sala')">‚¨Ö Volver</button></div>
      </div>
    </section>

    <!-- MI CUENTA -->
    <section id="page-cuenta" class="page">
      <div class="card">
        <h2 style="margin:0;color:var(--gold);font-size:28px">üë§ Mi Cuenta</h2>
        <div style="margin-top:14px">
          <p><strong>Usuario:</strong> <span id="accName">‚Äî</span></p>
          <p><strong>Registrado:</strong> <span id="accCreated">‚Äî</span></p>
          <div style="margin-top:10px"><button class="btn ghost" onclick="logout()">Cerrar sesi√≥n</button></div>
        </div>
        <div style="text-align:center;margin-top:18px"><button class="btn ghost" onclick="navTo('page-sala')">‚¨Ö Volver</button></div>
      </div>
    </section>

    <!-- PEDIDOS -->
    <section id="page-pedidos" class="page">
      <div class="card">
        <h2 style="margin:0;color:var(--gold);font-size:28px">üì¶ Pedidos</h2>
        <p style="color:var(--muted);margin-top:12px">Aqu√≠ aparecen tus pedidos (demo local).</p>
        <div style="text-align:center;margin-top:18px"><button class="btn ghost" onclick="navTo('page-sala')">‚¨Ö Volver</button></div>
      </div>
    </section>

  </div> <!-- /wrap -->

  <!-- floating chat (fab) + chat box (single, funcional) -->
  <button id="chatFab" class="chat-fab" title="Chat global" aria-label="Abrir chat">‚òÅÔ∏è</button>

  <div id="chatBox" class="chat-box" style="display:none;">
    <div class="chat-header">üí¨ Chat Global
      <button style="float:right;background:transparent;border:none;color:white;font-weight:900;cursor:pointer" id="closeChatBtn" aria-label="Cerrar chat">‚úï</button>
    </div>
    <div id="messages" class="chat-messages"></div>
    <div class="chat-input">
      <input id="msgInput" type="text" placeholder="Escribe un mensaje..." />
      <button id="sendMsg">Enviar</button>
    </div>
  </div>

  <!-- WhatsApp floating button (FAB) -->
  <a id="whatsappButton" href="https://wa.me/51922184802?text=¬°Hola!%20Estoy%20interesado%20en%20tu%20tienda%20DavidStore%20üõçÔ∏è" target="_blank" rel="noopener" aria-label="Contactar por WhatsApp" title="WhatsApp">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp"/>
  </a>

  <!-- CREATE ACCOUNT MODAL (overlay) -->
  <div id="modalBackdrop" class="modal-backdrop">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <h3 id="modalTitle">Crear cuenta</h3>
      <input id="newUser" class="input" placeholder="Usuario (√∫nico)" />
      <input id="newPass" class="input" type="password" placeholder="Contrase√±a" />
      <div class="row" style="margin-top:8px">
        <button id="modalSave" class="btn" type="button">Guardar</button>
        <button id="modalCancel" class="btn ghost">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Loading overlay -->
  <div id="loadingOverlay" style="display:none;align-items:center;justify-content:center;flex-direction:column;">
    <div class="loader-ring"></div>
    <div>Cargando...</div>
  </div>

<!-- üö® Alerta: sin conexi√≥n -->
<div id="netStatus" 
     style="
       display:none;
       position:fixed;
       top:50%;
       left:50%;
       transform:translate(-50%,-50%);
       background:linear-gradient(90deg,#ff0000,#ff4444);
       color:#fff;
       padding:24px 38px;
       border-radius:20px;
       font-size:22px;
       font-weight:900;
       text-align:center;
       text-shadow:0 0 12px rgba(0,0,0,0.8);
       box-shadow:0 0 60px rgba(255,0,0,0.8);
       animation:alertFlash 0.9s infinite alternate;
       z-index:999999;
     ">
  üö® SIN CONEXI√ìN A INTERNET üö®<br>
  <span style="font-size:16px;font-weight:600;">Verifica tu Wi-Fi o datos m√≥viles</span>
</div>

<style>
@keyframes alertFlash {
  0% {
    filter:brightness(1);
    transform:translate(-50%,-50%) scale(1);
    box-shadow:0 0 20px rgba(255,0,0,0.6);
  }
  100% {
    filter:brightness(1.4);
    transform:translate(-50%,-50%) scale(1.06);
    box-shadow:0 0 50px rgba(255,0,0,1);
  }
}
</style>

<script type="module">
  // Import √∫nico de Firebase (lo usamos todo aqu√≠)
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import {
    getFirestore,
    collection,
    addDoc,
    getDocs,
    query,
    where,
    orderBy,
    onSnapshot,
    serverTimestamp
  } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

  // Config Firebase (tu config original)
  const firebaseConfig = {
    apiKey: "AIzaSyAKrBTAkJGhB9s3E3MExqzj8mtXgKYsWRc",
    authDomain: "davidstore-51f7f.firebaseapp.com",
    projectId: "davidstore-51f7f",
    storageBucket: "davidstore-51f7f.firebasestorage.app",
    messagingSenderId: "363278778609",
    appId: "1:363278778609:web:0714ebb6903b931a616950",
    measurementId: "G-LJL6HXG11E"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Elementos
  const modalBackdrop = document.getElementById('modalBackdrop');
  const modalSave = document.getElementById('modalSave');
  const modalCancel = document.getElementById('modalCancel');
  const btnCreate = document.getElementById('btnCreate');
  const btnLogin = document.getElementById('btnLogin');
  const loadingOverlay = document.getElementById('loadingOverlay');

  // Floater elements
  const whatsappButton = document.getElementById('whatsappButton'); // anchor principal (FAB)
  const chatFab = document.getElementById('chatFab');
  const chatBox = document.getElementById('chatBox');

  // Chat elements
  const sendBtn = document.getElementById('sendMsg');
  const msgInput = document.getElementById('msgInput');
  const messagesDiv = document.getElementById('messages');
  const closeChatBtn = document.getElementById('closeChatBtn');

  // Mostrar modal crear cuenta
  btnCreate.addEventListener('click', () => {
    modalBackdrop.style.display = 'flex';
    document.getElementById('newUser').value = '';
    document.getElementById('newPass').value = '';
  });

  modalCancel.addEventListener('click', () => { modalBackdrop.style.display = 'none'; });

  // Crear cuenta (protege contra double click)
  modalSave.addEventListener('click', async () => {
    const user = document.getElementById('newUser').value.trim();
    const pass = document.getElementById('newPass').value.trim();
    if (!user || !pass) return alert('Completa usuario y contrase√±a.');

    modalSave.disabled = true;
    modalSave.innerText = 'Creando...';

    try {
      const usuariosRef = collection(db, 'usuarios');
      await addDoc(usuariosRef, { user, pass, created: new Date().toISOString(), vip:false });
      alert('‚úÖ Cuenta creada con √©xito. Ahora inicia sesi√≥n.');
      modalBackdrop.style.display = 'none';
      document.getElementById('newUser').value = '';
      document.getElementById('newPass').value = '';
    } catch (err) {
      console.error('Error al crear cuenta:', err);
      alert('‚ö†Ô∏è Error al crear cuenta (ver consola).');
    } finally {
      modalSave.disabled = false;
      modalSave.innerText = 'Guardar';
    }
  });

  // helper: show/hide floater buttons (used after successful login)
  function showFloaters() {
    if (whatsappButton) {
      whatsappButton.style.display = 'flex';
      whatsappButton.style.alignItems = 'center';
      whatsappButton.style.justifyContent = 'center';
    }
    if (chatFab) chatFab.style.display = 'flex';
  }
  function hideFloaters() {
    if (whatsappButton) whatsappButton.style.display = 'none';
    if (chatFab) chatFab.style.display = 'none';
    if (chatBox) chatBox.style.display = 'none';
  }

  // LOGIN
  btnLogin.addEventListener('click', async () => {
    const user = document.getElementById('username').value.trim();
    const pass = document.getElementById('password').value.trim();
    if (!user || !pass) return alert('Completa usuario y contrase√±a.');

    // mostrar loading
    loadingOverlay.style.display = 'flex';

    try {
      const usuariosRef = collection(db, 'usuarios');
      const q = query(usuariosRef, where('user', '==', user), where('pass', '==', pass));
      const resultado = await getDocs(q);

      if (resultado.empty) {
        alert('‚ùå Usuario o contrase√±a incorrectos.');
        loadingOverlay.style.display = 'none';
        return;
      }

      // Evita m√∫ltiples alertas repetidas
      if (!window.hasWelcomed) {
        window.hasWelcomed = true;
        alert(`‚úÖ Bienvenido ${user}`);
      }

      // Ocultar login, mostrar sala
      document.getElementById('loginCard').style.display = 'none';
      document.getElementById('page-sala').classList.add('active');

      // Mostrar los botones flotantes SOLO despu√©s del login
      showFloaters();

      // Mostrar el chat global al iniciar sesi√≥n (opcional)
      if (chatBox) chatBox.style.display = 'flex';

      document.getElementById('salaWelcome').innerText = `Conectado: ${user}`;
      document.getElementById('accName').innerText = user;
      document.getElementById('accCreated').innerText = new Date().toLocaleString();
    } catch (err) {
      console.error('Error al verificar usuario:', err);
      alert('‚ö†Ô∏è Error al conectar con Firebase (ver consola).');
    } finally {
      loadingOverlay.style.display = 'none';
    }
  });

  // NAV
  window.navTo = (id) => {
    document.querySelectorAll('section.page').forEach(p => p.classList.remove('active'));
    const el = document.getElementById(id);
    if (el) el.classList.add('active');
  };

  // LOGOUT - CORREGIDO: ahora oculta TODAS las "pages" y limpia inputs para que no quede el bloque visible.
  window.logout = () => {
    alert('üëã Sesi√≥n cerrada.');
    window.hasWelcomed = false;

    // 1) Ocultar todas las secciones de tipo "page" (incluye page-cuenta)
    document.querySelectorAll('section.page').forEach(p => p.classList.remove('active'));

    // 2) Mostrar el login y limpiar datos visibles
    const loginCard = document.getElementById('loginCard');
    if (loginCard) loginCard.style.display = 'block';

    document.getElementById('accName').innerText = '‚Äî';
    document.getElementById('accCreated').innerText = '‚Äî';

    // 3) Ocultar flotantes y chat
    hideFloaters();
    if (chatBox) chatBox.style.display = 'none';

    // 4) Limpiar campos del formulario de login para evitar residuos visuales
    const u = document.getElementById('username');
    const p = document.getElementById('password');
    if (u) u.value = '';
    if (p) p.value = '';

    // 5) Mover la vista al inicio (√∫til en m√≥vil)
    try { window.scrollTo({ top: 0, behavior: 'smooth' }); } catch(e){ /* ignore */ }
  };

  // WhatsApp click - abrir en nueva pesta√±a es manejado por el anchor; aqu√≠ evitamos navegaci√≥n accidental si JS quiere controlar.
  if (whatsappButton) {
    whatsappButton.addEventListener('click', (e) => {
      // anchor already has href; keep default. but we can track clicks or close UI if needed
      // no preventDefault -> opens in new tab because target="_blank"
    });
  }

  // ======================
  // CHAT GLOBAL (Firestore)
  // ======================
  // Evitar doble inicializaci√≥n
  if (!window.chatInitDone) {
    window.chatInitDone = true;

    // toggle chat
    if (chatFab) {
      chatFab.addEventListener('click', ()=> {
        if (!chatBox) return;
        chatBox.style.display = chatBox.style.display === 'none' ? 'flex' : 'none';
      });
    }
    if (closeChatBtn) closeChatBtn.addEventListener('click', ()=> chatBox.style.display = 'none');

    // enviar mensaje
    async function sendMessage(){
      const text = msgInput.value.trim();
      if (!text) return;
      const userName = (document.getElementById('accName') && document.getElementById('accName').innerText !== '‚Äî')
                       ? document.getElementById('accName').innerText
                       : (document.getElementById('username') ? document.getElementById('username').value.trim() || 'Invitado' : 'Invitado');
      try {
        await addDoc(collection(db, 'chatGlobal'), {
          user: userName,
          text,
          time: serverTimestamp()
        });
        msgInput.value = '';
      } catch (e) {
        console.error('Error enviando mensaje:', e);
        alert('Error al enviar mensaje (ver consola).');
      }
    }

    if (sendBtn) sendBtn.addEventListener('click', sendMessage);
    if (msgInput) msgInput.addEventListener('keydown', (ev) => { if(ev.key === 'Enter') sendMessage(); });

    // recibir mensajes en tiempo real
    const qMessages = query(collection(db, 'chatGlobal'), orderBy('time'));
    onSnapshot(qMessages, (snapshot) => {
      messagesDiv.innerHTML = '';
      snapshot.forEach(doc => {
        const d = doc.data();
        const div = document.createElement('div');
        div.className = 'chat-message';
        if (document.getElementById('accName') && d.user === document.getElementById('accName').innerText) {
          div.className += ' me';
        }
        const meta = document.createElement('div');
        meta.className = 'meta';
        let ts = '';
        try {
          if (d.time && d.time.toDate) ts = d.time.toDate().toLocaleTimeString();
        } catch(e){ ts = ''; }
        meta.textContent = (d.user || 'Invitado') + (ts ? ' ‚Ä¢ ' + ts : '');
        const body = document.createElement('div');
        body.textContent = d.text || '';
        div.appendChild(meta);
        div.appendChild(body);
        messagesDiv.appendChild(div);
      });
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    });
  }

  // Por defecto ocultamos los botones al cargar
  hideFloaters();

  // OFFLINE notifier (simple)
  const offlineMsg = document.createElement('div');
  offlineMsg.textContent = '‚ö†Ô∏è Sin conexi√≥n a Internet. Verifica tu red.';
  offlineMsg.style.position = 'fixed';
  offlineMsg.style.top = '50%';
  offlineMsg.style.left = '50%';
  offlineMsg.style.transform = 'translate(-50%, -50%)';
  offlineMsg.style.backgroundColor = 'rgba(255, 0, 0, 0.9)';
  offlineMsg.style.color = 'white';
  offlineMsg.style.padding = '20px 30px';
  offlineMsg.style.fontSize = '18px';
  offlineMsg.style.fontWeight = 'bold';
  offlineMsg.style.borderRadius = '10px';
  offlineMsg.style.zIndex = '9999';
  offlineMsg.style.display = 'none';
  offlineMsg.style.boxShadow = '0 0 20px rgba(255,0,0,0.7)';
  document.body.appendChild(offlineMsg);

  function updateOnlineStatus() {
    if (navigator.onLine) {
      offlineMsg.style.display = 'none';
    } else {
      offlineMsg.style.display = 'block';
    }
  }
  window.addEventListener('online', updateOnlineStatus);
  window.addEventListener('offline', updateOnlineStatus);
  updateOnlineStatus();

</script>

<!-- FONDO ROJO CON RAYOS ‚ö° -->
<style>
  body {
    background: radial-gradient(circle at center, #ff0000 0%, #2a0000 100%);
    overflow: hidden;
    position: relative;
  }

  .rayo {
    position: absolute;
    width: 3px;
    height: 250px;
    background: white;
    box-shadow:
      0 0 20px white,
      0 0 40px #ffffff,
      0 0 60px #ff0000;
    opacity: 0;
    transform: rotate(25deg) scaleY(0);
    animation: rayoAnim 2s infinite ease-in-out;
  }

  .rayo.negro {
    background: black;
    box-shadow:
      0 0 10px #000,
      0 0 20px #222;
  }

  @keyframes rayoAnim {
    0%, 85%, 100% {
      opacity: 0;
      transform: rotate(25deg) scaleY(0);
    }
    10%, 40% {
      opacity: 1;
      transform: rotate(25deg) scaleY(1.3);
    }
  }

  /* Posiciones aleatorias de los rayos */
  .rayo:nth-child(1) { left: 10%; top: 20%; animation-delay: 0s; }
  .rayo:nth-child(2) { left: 30%; top: 50%; animation-delay: 0.4s; }
  .rayo:nth-child(3) { left: 55%; top: 10%; animation-delay: 0.8s; }
  .rayo:nth-child(4) { left: 70%; top: 60%; animation-delay: 1.2s; }
  .rayo:nth-child(5) { left: 85%; top: 30%; animation-delay: 1.6s; }
  .rayo:nth-child(6) { left: 40%; top: 80%; animation-delay: 2s; }
</style>

<!-- Rayos animados -->
<div class="rayo"></div>
<div class="rayo negro"></div>
<div class="rayo"></div>
<div class="rayo negro"></div>
<div class="rayo"></div>
<div class="rayo negro"></div>
<!-- FIN FONDO ROJO CON RAYOS ‚ö° -->

<!-- INJECTED FIREBASE + APP LOGIC (MODIFIED BY CHATGPT) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import {
    getFirestore, collection, addDoc, getDocs, query, where, doc, getDoc, updateDoc, setDoc, onSnapshot, orderBy, serverTimestamp
  } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

  // --- TU FIREBASE CONFIG (ya estaba en tu proyecto) ---
  const firebaseConfig = {
    apiKey: "AIzaSyAKrBTAkJGhB9s3E3MExqzj8mtXgKYsWRc",
    authDomain: "davidstore-51f7f.firebaseapp.com",
    projectId: "davidstore-51f7f",
    storageBucket: "davidstore-51f7f.firebasestorage.app",
    messagingSenderId: "363278778609",
    appId: "1:363278778609:web:0714ebb6903b931a616950",
    measurementId: "G-LJL6HXG11E"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Utility: show alerts and simple loader if available
  function toast(msg){ try{ alert(msg); }catch(e){ console.log(msg); } }

  // Ensure default admin user and default products exist (best-effort; non-destructive)
  async function ensureDefaults(){
    try{
      // admin David / 1030
      const usuariosRef = collection(db,'usuarios');
      const q = query(usuariosRef, where('user','==','David'));
      const r = await getDocs(q);
      if(r.empty){
        await addDoc(usuariosRef, { user:'David', pass:'1030', created: new Date().toISOString(), vip:true, saldo:0 });
        console.log('Admin David creado');
      } else {
        // make sure vip true
        const d = r.docs[0];
        const data = d.data();
        if(!data.vip){
          await updateDoc(doc(db,'usuarios', d.id), { vip:true });
          console.log('Admin David actualizado a vip');
        }
      }

      // default products list: Remote, BrickLin, Geebox, BR MODS, Drip Client
      const defaults = [
        { title:'Remote', desc:'Servicio Remote', resetLink:'', prices:{'7':7,'15':15,'30':25} },
        { title:'BrickLin', desc:'Servicio BrickLin', resetLink:'', prices:{'7':7,'15':15,'30':25} },
        { title:'Geebox', desc:'Servicio Geebox', resetLink:'', prices:{'7':7,'15':15,'30':25} },
        { title:'BR MODS', desc:'PREGUNTA PRECIOS AL PRIVADO', resetLink:'https://brmods.net/painel/reset_temp.php?key=8e217bf6ea5accb8fbdac2e79d5ed3e8381fd2347b7c5ea3c9487d2a85c56aec', prices:{'7':7,'15':15,'30':25} },
        { title:'Drip Client', desc:'PREGUNTA PRECIOS AL PRIVADO', resetLink:'https://brmods.net/painel/reset_temp.php?key=8e217bf6ea5accb8fbdac2e79d5ed3e8381fd2347b7c5ea3c9487d2a85c56aec', prices:{'7':7,'15':15,'30':25} }
      ];
      const prodsSnap = await getDocs(collection(db,'productos'));
      const existing = new Set();
      prodsSnap.forEach(p=>{ const d = p.data(); if(d && d.title) existing.add(d.title); });
      for(const def of defaults){
        if(!existing.has(def.title)){
          await addDoc(collection(db,'productos'), def);
          console.log('Producto por defecto creado', def.title);
        }
      }
    }catch(e){ console.error('ensureDefaults error', e); }
  }

  // UI helpers: try to find elements in the original DOM or create fallbacks
  const getEl = id => document.getElementById(id);
  function setText(id, txt){ const el = getEl(id); if(el) el.textContent = txt; }

  // Fill account UI when user logs in
  async function populateAccountUI(docRef){
    try{
      const snap = await getDoc(docRef);
      if(!snap.exists()) return;
      const data = snap.data();
      setText('accName', data.user || '‚Äî');
      setText('accSaldo', (Number(data.saldo||0)).toFixed(2));
      setText('accCreated', data.created || new Date().toLocaleString());
      if(data.vip || data.user==='David'){ const adminLink = getEl('adminLink'); if(adminLink) adminLink.style.display='inline-flex'; }
    }catch(e){ console.error(e); }
  }

  // Login handler (connects to original login button id 'btnLogin')
  const btnLogin = getEl('btnLogin');
  if(btnLogin){
    btnLogin.addEventListener('click', async ()=>{
      const user = (getEl('username')||{}).value?.trim() || '';
      const pass = (getEl('password')||{}).value?.trim() || '';
      if(!user || !pass) return toast('Completa usuario y contrase√±a.');
      try{
        const usuariosRef = collection(db,'usuarios');
        const q = query(usuariosRef, where('user','==', user), where('pass','==', pass));
        const r = await getDocs(q);
        if(r.empty){ return toast('Usuario o contrase√±a incorrectos.'); }
        const udoc = r.docs[0];
        // save session
        localStorage.setItem('kcf_user', JSON.stringify({ id: udoc.id, user: udoc.data().user, vip: !!udoc.data().vip }));
        // populate UI
        await populateAccountUI(doc(db,'usuarios', udoc.id));
        // show sala if exists
        const loginCard = getEl('loginCard'); if(loginCard) loginCard.style.display='none';
        const sala = getEl('page-sala'); if(sala) sala.classList.add('active');
        const salaWelcome = getEl('salaWelcome'); if(salaWelcome) salaWelcome.innerText = 'Conectado: ' + udoc.data().user;
        toast('‚úÖ Bienvenido ' + udoc.data().user);
      }catch(e){ console.error('login error', e); toast('Error al conectar con Firebase'); }
    });
  }

  // Create account handler (btnCreate)
  const btnCreate = getEl('btnCreate');
  if(btnCreate){
    btnCreate.addEventListener('click', async ()=>{
      const u = prompt('Usuario (texto)'); if(!u) return;
      const p = prompt('Contrase√±a'); if(!p) return;
      try{
        await addDoc(collection(db,'usuarios'), { user:u, pass:p, created:new Date().toISOString(), vip:false, saldo:0 });
        toast('Cuenta creada. Inicia sesi√≥n con tus datos.');
      }catch(e){ console.error(e); toast('Error creando cuenta'); }
    });
  }

  // Load products into #productsWrap (keeps only desired products if present)
  async function loadProducts(){
    const wrap = getEl('productsWrap');
    if(!wrap) return;
    wrap.innerHTML = 'Cargando...';
    try{
      const prodsSnap = await getDocs(collection(db,'productos'));
      const wantedTitles = ['Remote','BrickLin','Geebox','BR MODS','Drip Client'];
      const list = [];
      prodsSnap.forEach(p=>{ const d = p.data(); if(d && d.title && wantedTitles.includes(d.title)) list.push({ id:p.id, data:d }); });
      // If none found for any wanted, create client-side placeholders (do not overwrite DB)
      const missing = wantedTitles.filter(t => !list.some(x=>x.data.title===t));
      for(const m of missing){
        list.push({ id: m.toLowerCase()+'-default', data: { title: m, desc: 'PREGUNTA PRECIOS AL PRIVADO', resetLink:'', prices:{'7':7,'15':15,'30':25} } });
      }
      wrap.innerHTML='';
      for(const p of list){
        const d = p.data;
        const card = document.createElement('div'); card.className='product-card';
        const title = document.createElement('div'); title.className='product-title'; title.textContent = d.title;
        const desc = document.createElement('div'); desc.className='product-desc'; desc.textContent = d.desc || '';
        const durWrap = document.createElement('div');
        const durations = [7,15,30];
        const prices = d.prices || {'7':7,'15':15,'30':25};
        durations.forEach(days=>{ const row = document.createElement('div'); row.style.display='flex'; row.style.justifyContent='space-between'; row.style.alignItems='center'; row.style.marginTop='8px';
          const left = document.createElement('div'); left.innerHTML = `<strong>${days} d√≠as</strong>`;
          const right = document.createElement('div'); right.style.display='flex'; right.style.gap='8px'; const price = prices[String(days)] || 0;
          const priceEl = document.createElement('div'); priceEl.textContent = '$'+Number(price).toFixed(2);
          const buyBtn = document.createElement('button'); buyBtn.className='product-cta'; buyBtn.textContent='Comprar';
          buyBtn.onclick = ()=> purchase(p.id, d.title, days, price);
          right.appendChild(priceEl); right.appendChild(buyBtn);
          row.appendChild(left); row.appendChild(right); durWrap.appendChild(row);
        });
        const info = document.createElement('div'); info.style.marginTop='10px'; const link = document.createElement('a'); link.className='product-cta'; link.href = d.resetLink || '#'; link.target='_blank'; link.textContent='Reset / Info';
        info.appendChild(link);
        card.appendChild(title); card.appendChild(desc); card.appendChild(durWrap); card.appendChild(info);
        wrap.appendChild(card);
      }
    }catch(e){ console.error(e); wrap.innerHTML='Error cargando productos'; }
  }

  // Purchase flow: check saldo, find key, assign, deduct saldo, create pedido
  async function purchase(prodId, prodTitle, days, price){
    const s = localStorage.getItem('kcf_user');
    if(!s) return toast('Inicia sesi√≥n para comprar.');
    const user = JSON.parse(s);
    showLoader(true);
    try{
      const uref = doc(db,'usuarios', user.id);
      const usnap = await getDoc(uref);
      const saldo = Number(usnap.data().saldo||0);
      if(saldo < price){ toast('Saldo insuficiente'); showLoader(false); return; }

      // find available key in subcollection productos/{prodId}/keys
      const keysCol = collection(db, `productos/${prodId}/keys`);
      const kq = query(keysCol, where('duration','==', days), where('used','==', false), orderBy('duration'));
      const ks = await getDocs(kq);
      if(ks.empty){ toast('Agotado - sin claves disponibles'); showLoader(false); return; }
      const keyDoc = ks.docs[0];
      const keyData = keyDoc.data();

      // mark key used, deduct saldo, create pedido
      await updateDoc(doc(db, `productos/${prodId}/keys`, keyDoc.id), { used:true, assignedTo:user.id, assignedAt: serverTimestamp() });
      await updateDoc(uref, { saldo: saldo - price });
      await addDoc(collection(db,'pedidos'), { userId: user.id, user: user.user, productId: prodId, productTitle: prodTitle, duration: days, price: price, clave: keyData.key, created: serverTimestamp(), status:'completed' });

      // create receipt in UI
      const receipt = `<div style="color:#021223;background:#eaf6ff;padding:14px;border-radius:10px">
        <h3>Boleta ‚Äî ${prodTitle}</h3>
        <p>Usuario: <strong>${user.user}</strong></p>
        <p>Duraci√≥n: <strong>${days} d√≠as</strong></p>
        <p>Precio: <strong>$${price.toFixed(2)}</strong></p>
        <p>Clave: <code>${keyData.key}</code></p>
        <p>Fecha: ${new Date().toLocaleString()}</p>
        <div style="margin-top:8px"><button onclick="window.print()" class="btn">Imprimir / Guardar PDF</button></div>
      </div>`;
      toast('Compra exitosa');
      const pedidosList = getEl('pedidosList');
      if(pedidosList) pedidosList.innerHTML = receipt;
      // update displayed saldo
      setText('accSaldo', (saldo - price).toFixed(2));
    }catch(e){ console.error('purchase error', e); toast('Error al comprar: '+e); }
    finally{ showLoader(false); }
  }

  // Simple loader control (uses #loader if present)
  function showLoader(v){ const L = document.getElementById('loader'); if(L) L.style.display = v? 'flex':'none'; }

  // Admin page helpers: only accessible via admin.html link already present in document
  async function adminLoadUsers(){ const ucont = document.getElementById('users'); const sel = document.getElementById('selUser'); if(!ucont||!sel) return; ucont.innerText='Cargando...'; sel.innerHTML=''; const all = await getDocs(collection(db,'usuarios')); ucont.innerHTML=''; all.forEach(u=>{ const d = u.data(); const el = document.createElement('div'); el.innerHTML = `<strong>${d.user}</strong> ‚Äî $${(d.saldo||0)} (id: ${u.id})`; ucont.appendChild(el); const opt = document.createElement('option'); opt.value = u.id; opt.textContent = d.user; sel.appendChild(opt); }); }
  async function adminLoadProducts(){ const sel = document.getElementById('selProd'); if(!sel) return; sel.innerHTML=''; const all = await getDocs(collection(db,'productos')); all.forEach(p=>{ const d = p.data(); const opt = document.createElement('option'); opt.value = p.id; opt.textContent = d.title; sel.appendChild(opt); }); }

  // Wire admin buttons if present
  const btnRec = getEl('btnRec'); if(btnRec){ btnRec.addEventListener('click', async ()=>{ const uid = getEl('selUser').value; const amt = Number(getEl('recAmt').value); if(!uid||!amt||amt<10) return toast('Selecciona usuario y monto m√≠nimo $10'); const uref = doc(db,'usuarios',uid); const snap = await getDoc(uref); const cur = snap.exists()? (snap.data().saldo||0) : 0; await updateDoc(uref,{ saldo: cur + amt }); toast('Recargado $'+amt); adminLoadUsers(); }); }
  const btnAddProd = getEl('btnAddProd'); if(btnAddProd){ btnAddProd.addEventListener('click', async ()=>{ const t = (getEl('prodTitle')||{}).value?.trim(); if(!t) return toast('Titulo requerido'); const p = { "7": Number((getEl('p7')||{}).value)||7, "15": Number((getEl('p15')||{}).value)||15, "30": Number((getEl('p30')||{}).value)||25 }; await addDoc(collection(db,'productos'), { title:t, desc:(getEl('prodDesc')||{}).value||'', resetLink:(getEl('prodReset')||{}).value||'', prices:p }); toast('Producto creado'); adminLoadProducts(); }); }
  const btnAddKeys = getEl('btnAddKeys'); if(btnAddKeys){ btnAddKeys.addEventListener('click', async ()=>{ const prod = getEl('selProd').value; const dur = Number(getEl('selDur').value); const lines = (getEl('keysArea')||{}).value.split('\\n').map(s=>s.trim()).filter(Boolean); if(!prod||lines.length===0) return toast('Selecciona producto y pega claves'); for(const k of lines) await addDoc(collection(db,`productos/${prod}/keys`), { duration: dur, key: k, used:false }); toast('Claves agregadas: '+lines.length); getEl('keysArea').value=''; }); }
  const btnToggle = getEl('btnToggle'); if(btnToggle){ btnToggle.addEventListener('click', async ()=>{ const cfgRef = doc(db,'config','settings'); const snap = await getDoc(cfgRef); const cur = snap.exists()? (snap.data().mantenimiento===true) : false; await setDoc(cfgRef, { mantenimiento: !cur }, { merge:true }); toast('Mantenimiento: '+(!cur)); }); }

  // On load actions
  window.addEventListener('load', async ()=>{ await ensureDefaults(); loadProducts(); // if user session exists, populate UI
    const s = localStorage.getItem('kcf_user'); if(s){ try{ const u = JSON.parse(s); await populateAccountUI(doc(db,'usuarios', u.id)); }catch(e){} }
    // if admin page present, load lists
    if(location.pathname.endsWith('admin.html') || location.href.includes('admin.html')){ adminLoadUsers(); adminLoadProducts(); }
  });
</script>
<!-- END INJECTED --></body>
</html>